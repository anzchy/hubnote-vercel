# HubNote 自定义域名绑定指南

本指南详细介绍如何将 Vercel 部署的 HubNote 项目与自定义域名 `hubnote.jackcheng.tech` 绑定。

## 🎯 配置概览

**目标域名**: `hubnote.jackcheng.tech`  
**当前 Vercel URL**: `https://hubnote-e793pbbov-anzchy-163coms-projects.vercel.app`  
**DNS 提供商**: Cloudflare  
**部署平台**: Vercel  

## 📋 配置步骤

### 第一步：Vercel 平台配置

#### 1.1 登录 Vercel 控制台

1. 访问 [Vercel Dashboard](https://vercel.com/dashboard)
2. 登录您的 Vercel 账户
3. 找到并点击 HubNote 项目

#### 1.2 添加自定义域名

1. 在项目页面中，点击 **"Settings"** 标签
2. 在左侧菜单中选择 **"Domains"**
3. 在 "Add Domain" 输入框中输入：`hubnote.jackcheng.tech`
4. 点击 **"Add"** 按钮

#### 1.3 获取 DNS 配置信息

添加域名后，Vercel 会显示需要配置的 DNS 记录：

```
类型: CNAME
名称: hubnote
值: cname.vercel-dns.com
```

或者可能显示为：

```
类型: A
名称: hubnote
值: 76.76.19.61
```

**重要**: 记录下 Vercel 提供的具体值，因为可能会有所不同。

### 第二步：Cloudflare DNS 配置

#### 2.1 登录 Cloudflare

1. 访问 [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. 登录您的 Cloudflare 账户
3. 选择 `jackcheng.tech` 域名

#### 2.2 添加 DNS 记录

1. 点击 **"DNS"** 标签
2. 点击 **"Add record"** 按钮
3. 配置 DNS 记录：

**方案 A：CNAME 记录（推荐）**
```
类型: CNAME
名称: hubnote
目标: cname.vercel-dns.com
TTL: Auto
代理状态: 🟠 仅限 DNS（关闭代理）
```

**方案 B：A 记录**
```
类型: A
名称: hubnote
IPv4 地址: 76.76.19.61
TTL: Auto
代理状态: 🟠 仅限 DNS（关闭代理）
```

#### 2.3 重要配置说明

⚠️ **关键设置**：
- **代理状态必须设置为 "仅限 DNS"**（灰色云朵图标）
- **不要启用 Cloudflare 代理**（橙色云朵图标），否则会导致 SSL 证书问题

### 第三步：验证配置

#### 3.1 DNS 传播检查

使用以下命令检查 DNS 是否正确配置：

```bash
# 检查 CNAME 记录
nslookup hubnote.jackcheng.tech

# 或使用 dig 命令
dig hubnote.jackcheng.tech
```

#### 3.2 Vercel 验证

1. 返回 Vercel 项目的 Domains 设置页面
2. 等待域名状态变为 **"Valid Configuration"**
3. 如果显示错误，检查 DNS 配置是否正确

#### 3.3 SSL 证书自动配置

Vercel 会自动为自定义域名配置 SSL 证书：
- 证书类型：Let's Encrypt
- 自动续期：是
- HTTPS 重定向：自动启用

### 第四步：测试访问

#### 4.1 浏览器测试

1. 打开浏览器访问：`https://hubnote.jackcheng.tech`
2. 确认页面正常加载
3. 检查 SSL 证书是否有效（地址栏显示锁图标）

#### 4.2 功能测试

测试 HubNote 的主要功能：
- ✅ 首页加载
- ✅ GitHub 仓库添加
- ✅ Issues 浏览
- ✅ 评论功能
- ✅ 用户认证

## 🔧 高级配置

### 子域名重定向（可选）

如果需要将 `www.hubnote.jackcheng.tech` 重定向到 `hubnote.jackcheng.tech`：

#### Cloudflare 配置：
```
类型: CNAME
名称: www.hubnote
目标: hubnote.jackcheng.tech
TTL: Auto
代理状态: 🟧 已代理（启用代理）
```

#### Vercel 配置：
在 Vercel Domains 设置中同时添加：
- `hubnote.jackcheng.tech`（主域名）
- `www.hubnote.jackcheng.tech`（重定向域名）

### 自定义 CNAME 文件

在项目根目录创建 `public/CNAME` 文件（如果使用静态部署）：

```
hubnote.jackcheng.tech
```

## 🚨 常见问题排查

### 问题 1：域名无法访问

**可能原因**：
- DNS 记录配置错误
- DNS 传播未完成（最多需要 48 小时）
- Cloudflare 代理设置错误

**解决方案**：
1. 检查 DNS 记录是否正确
2. 确保 Cloudflare 代理状态为 "仅限 DNS"
3. 等待 DNS 传播完成

### 问题 2：SSL 证书错误

**可能原因**：
- Cloudflare 代理干扰 SSL 验证
- DNS 记录指向错误

**解决方案**：
1. 关闭 Cloudflare 代理（设置为仅限 DNS）
2. 等待 Vercel 重新生成 SSL 证书
3. 检查 DNS 记录是否指向正确的 Vercel 地址

### 问题 3：部分功能异常

**可能原因**：
- API 路径配置问题
- 环境变量未正确设置

**解决方案**：
1. 检查 Vercel 环境变量配置
2. 确认 API 路由正常工作
3. 查看 Vercel 函数日志

## 📊 配置验证清单

### Cloudflare 检查清单

- [ ] DNS 记录类型正确（CNAME 或 A）
- [ ] 记录名称为 `hubnote`
- [ ] 目标值与 Vercel 提供的一致
- [ ] 代理状态设置为 "仅限 DNS"
- [ ] TTL 设置为 Auto 或较短时间

### Vercel 检查清单

- [ ] 域名已添加到项目
- [ ] 域名状态显示 "Valid Configuration"
- [ ] SSL 证书状态为 "Valid"
- [ ] HTTPS 重定向已启用
- [ ] 环境变量配置正确

### 功能检查清单

- [ ] 域名可以正常访问
- [ ] HTTPS 证书有效
- [ ] 所有页面正常加载
- [ ] API 功能正常
- [ ] 静态资源加载正常

## 🔄 维护和监控

### 定期检查

1. **SSL 证书监控**：Vercel 自动续期，但建议定期检查
2. **DNS 记录验证**：确保 Cloudflare 记录未被意外修改
3. **性能监控**：使用 Vercel Analytics 监控访问情况

### 备份配置

记录当前配置信息以备将来参考：

```
域名: hubnote.jackcheng.tech
DNS 提供商: Cloudflare
部署平台: Vercel
SSL 提供商: Let's Encrypt (Vercel 自动)
配置日期: [填写配置日期]
```

## 📞 技术支持

如果遇到问题：

1. **Vercel 支持**：[Vercel Help Center](https://vercel.com/help)
2. **Cloudflare 支持**：[Cloudflare Support](https://support.cloudflare.com/)
3. **DNS 检查工具**：[DNS Checker](https://dnschecker.org/)
4. **SSL 检查工具**：[SSL Labs](https://www.ssllabs.com/ssltest/)

---

**配置完成后，您的 HubNote 应用将通过 `https://hubnote.jackcheng.tech` 访问，享受自定义域名带来的专业体验！**