{% extends "base.html" %}

{% block title %}{{ repo_name }} - Issues{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <div class="breadcrumb">
            <a href="{{ url_for('index') }}">ä»“åº“åˆ—è¡¨</a>
            <span class="breadcrumb-separator">/</span>
            <span>{{ repo_name }}</span>
        </div>
        <h1>{{ repo_name }} - Issues</h1>
    </div>

    <!-- ç­›é€‰å™¨ -->
    <div class="filters-section">
        <div class="filter-tabs">
            <a href="?state=all" class="filter-tab {% if state == 'all' %}active{% endif %}">å…¨éƒ¨</a>
            <a href="?state=open" class="filter-tab {% if state == 'open' %}active{% endif %}">å¼€æ”¾</a>
            <a href="?state=closed" class="filter-tab {% if state == 'closed' %}active{% endif %}">å·²å…³é—­</a>
        </div>
    </div>

    <!-- Issues åˆ—è¡¨ -->
    <div class="issues-section">
        {% if issues %}
            <div class="issues-list">
                {% for issue in issues %}
                <div class="issue-item">
                    <div class="issue-status">
                        <span class="status-badge status-{{ issue.state }}">
                            {% if issue.state == 'open' %}ğŸŸ¢{% else %}ğŸ”´{% endif %}
                        </span>
                    </div>
                    
                    <div class="issue-content">
                        <div class="issue-header">
                            <h3 class="issue-title">
                                <a href="{{ url_for('issues.issue_detail', repo_full_name=repo_name, issue_number=issue.number) }}">
                                    {{ issue.title }}
                                </a>
                            </h3>
                            <span class="issue-number">#{{ issue.number }}</span>
                        </div>
                        
                        {% if issue.body %}
                        <div class="issue-body">
                            <p>{{ issue.body | truncate(200) }}</p>
                        </div>
                        {% endif %}
                        
                        <div class="issue-labels">
                            {% for label in issue.labels %}
                            <span class="label" data-color="{{ label.color }}">
                                {{ label.name }}
                            </span>
                            {% endfor %}
                        </div>
                        
                        <div class="issue-meta">
                            <div class="issue-author">
                                <img src="{{ issue.user.avatar_url }}" alt="{{ issue.user.login }}" class="avatar-sm">
                                <span>{{ issue.user.login }}</span>
                            </div>
                            <span class="issue-time">åˆ›å»ºäº {{ issue.created_at | datetime }}</span>
                            {% if issue.comments_count > 0 %}
                            <span class="issue-comments">
                                <span class="comment-icon">ğŸ’¬</span>
                                {{ issue.comments_count }}
                            </span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="issue-actions">
                        <a href="{{ issue.html_url }}" target="_blank" class="btn btn-sm btn-outline">
                            åœ¨ GitHub æŸ¥çœ‹
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <!-- åˆ†é¡µ -->
            <div class="pagination">
                {% if current_page > 1 %}
                <a href="?page={{ current_page - 1 }}&state={{ state }}" class="btn btn-outline">ä¸Šä¸€é¡µ</a>
                {% endif %}
                <span class="page-info">ç¬¬ {{ current_page }} é¡µ</span>
                <a href="?page={{ current_page + 1 }}&state={{ state }}" class="btn btn-outline">ä¸‹ä¸€é¡µ</a>
            </div>
        {% else %}
            <div class="empty-state">
                <div class="empty-icon">ğŸ“</div>
                <h3>æ²¡æœ‰æ‰¾åˆ° Issues</h3>
                <p>è¿™ä¸ªä»“åº“ç›®å‰æ²¡æœ‰ {% if state == 'open' %}å¼€æ”¾çš„{% elif state == 'closed' %}å·²å…³é—­çš„{% endif %} Issues</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/issues.js') }}"></script>
{% endblock %}